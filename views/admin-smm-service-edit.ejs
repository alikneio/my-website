<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Edit SMM Service – <%= service.name %></title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <link rel="stylesheet" href="/css/bootstrap.css" />
  <link rel="stylesheet" href="/css/custom.css" />
  <link rel="stylesheet" href="/css/bootstrap-icons/font/bootstrap-icons.css" />
  <link
    href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap"
    rel="stylesheet"
  />
</head>
<body>
  <%- include('partials/admin-sidebar', { user: user }) %>

  <main class="main-content">
    <div class="container-fluid py-4" style="max-width: 1100px;">

      <!-- Header -->
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="h4 mb-0">
          <i class="bi bi-instagram"></i>
          Edit SMM Service
        </h1>

        <a href="/admin/smm-services" class="btn btn-outline-secondary btn-sm">
          <i class="bi bi-arrow-left"></i> Back to services
        </a>
      </div>

      <% if (message) { %>
        <div class="alert alert-info">
          <%= message %>
        </div>
      <% } %>

      <form
        method="post"
        action="/admin/smm-services/<%= service.id %>/edit"
        class="card shadow-sm"
      >
        <div class="card-body">
          <div class="row g-3">

            <!-- اسم الخدمة -->
            <div class="col-md-8">
              <label class="form-label">Service name</label>
              <input
                type="text"
                name="name"
                class="form-control"
                value="<%= service.name %>"
                required
              />
              <div class="form-text">
                This is what the customer will see in the store.
              </div>
            </div>

            <!-- مفعّل / غير مفعّل -->
            <div class="col-md-4">
              <label class="form-label">Status</label>
              <select name="is_active" class="form-select">
                <option value="1" <%= service.is_active ? 'selected' : '' %>>
                  Active
                </option>
                <option value="0" <%= !service.is_active ? 'selected' : '' %>>
                  Disabled
                </option>
              </select>
            </div>

            <!-- الكاتيجوري -->
            <div class="col-md-6">
              <label class="form-label">Store category</label>
              <select name="category_id" class="form-select">
                <option value="none">— none —</option>
                <% categories.forEach(function (c) { %>
                  <option
                    value="<%= c.id %>"
                    <%= String(service.category_id || '') === String(c.id) ? 'selected' : '' %>>
                    <%= c.name %>
                  </option>
                <% }) %>
              </select>
              <div class="form-text">
                Choose where this service appears in the social media categories.
              </div>
            </div>

            <!-- Rate + Rate per -->
            <div class="col-md-3">
              <label class="form-label">Rate</label>
              <input
                type="number"
                step="0.0001"
                name="rate"
                class="form-control"
                value="<%= Number(service.rate || 0).toFixed(4) %>"
                required
              />
              <div class="form-text">
                Price in USD for the selected unit.
              </div>
            </div>

            <div class="col-md-3">
              <label class="form-label">Rate unit</label>
              <input
                type="number"
                name="rate_per"
                class="form-control"
                value="<%= service.rate_per || 1000 %>"
                min="1"
                required
              />
              <div class="form-text">
                Unit for the rate (e.g. 1000, 10000, 100000).
              </div>
            </div>

            <!-- Min / Max -->
            <div class="col-md-3">
              <label class="form-label">Min qty</label>
              <input
                type="number"
                name="min_qty"
                class="form-control"
                value="<%= service.min_qty %>"
                required
              />
            </div>

            <div class="col-md-3">
              <label class="form-label">Max qty</label>
              <input
                type="number"
                name="max_qty"
                class="form-control"
                value="<%= service.max_qty %>"
                required
              />
            </div>

            <!-- Average time -->
            <div class="col-md-4">
              <label class="form-label">Average time</label>
              <input
                type="text"
                name="average_time"
                class="form-control"
                value="<%= service.average_time || '' %>"
                placeholder="Example: 0–5 minutes / 1–3 hours"
              />
              <div class="form-text">
                Shown to the customer on checkout. Free text (e.g. "Start: 0–5 min, Speed: 5k/day").
              </div>
            </div>

            <!-- Important notes -->
            <div class="col-md-8">
              <label class="form-label">Important notes (checkout)</label>
              <textarea
                name="notes"
                rows="6"
                class="form-control"
                placeholder="Each line will appear as a bullet point for the customer."
              ><%= service.notes || '' %></textarea>
              <div class="form-text">
                Each line will be shown as a separate bullet point on the checkout page.
              </div>
            </div>

            <!-- معلومات المزود -->
            <div class="col-12">
              <hr />
              <h6 class="text-muted mb-2">Provider information</h6>
              <div class="small text-muted">
                Provider service ID:
                <strong><%= service.provider_service_id %></strong>
              </div>
              <% if (service.provider_category) { %>
                <div class="small text-muted">
                  Provider category:
                  <strong><%= service.provider_category %></strong>
                </div>
              <% } %>
            </div>
          </div>
        </div>

        <div class="card-footer d-flex justify-content-between align-items-center">
          <span class="small text-muted">
            Last updated:
            <%= service.updated_at || 'N/A' %>
          </span>

          <button type="submit" class="btn btn-primary">
            <i class="bi bi-save"></i>
            Save changes
          </button>
        </div>
      </form>
    </div>
  </main>

  <script src="/js/bootstrap.bundle.min.js"></script>
</body>
</html>
